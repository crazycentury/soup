{"ast":null,"code":"import _slicedToArray from\"/Users/work/Documents/FinalProject/soup/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from\"react\";import Grid from\"@mui/material/Grid\";import PaymentIcon from\"@mui/icons-material/Payment\";import PaymentsIcon from\"@mui/icons-material/Payments\";import PersonIcon from\"@mui/icons-material/Person\";import{Navigate,useLocation}from\"react-router-dom\";import useAuth from\"../../hook/useAuth\";import Sidebar from\"./Sidebar\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var sidebarItems=[{text:\"Invoice\",icon:/*#__PURE__*/_jsx(PaymentsIcon,{}),path:\"/invoice\",child_pattern:/^\\/detailinvoice\\/\\d+$/,roles:[\"user\",\"admin\"]},{text:\"Payment Method\",icon:/*#__PURE__*/_jsx(PaymentIcon,{}),path:\"/admin/payment-method\",roles:[\"admin\"]},{text:\"User Page\",icon:/*#__PURE__*/_jsx(PersonIcon,{}),path:\"/admin/user\",roles:[\"admin\"]}];function isAuthorized(user,path){var sidebarItem=sidebarItems.find(function(item){return item.path===path||path.match(item.child_pattern);});return user&&sidebarItem.roles.some(function(role){return role===user.role_name;});}var BaseAdminView=function BaseAdminView(props){var location=useLocation();var _useAuth=useAuth(),user=_useAuth.user,isValidatingToken=_useAuth.isValidatingToken;var children=props.children;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),sidebarList=_useState2[0],setSidebarList=_useState2[1];useEffect(function(){var authorizedMenu=sidebarItems.filter(function(item){return isAuthorized(user,item.path);});setSidebarList(authorizedMenu);},[user]);if(!isValidatingToken&&!isAuthorized(user,location.pathname)){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}return/*#__PURE__*/_jsxs(Grid,{container:true,mt:12,children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:2,children:/*#__PURE__*/_jsx(Sidebar,{items:sidebarList,isAuthorized:isAuthorized})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:10,children:children})]});};export default BaseAdminView;","map":{"version":3,"names":["React","useEffect","useState","Grid","PaymentIcon","PaymentsIcon","PersonIcon","Navigate","useLocation","useAuth","Sidebar","sidebarItems","text","icon","path","child_pattern","roles","isAuthorized","user","sidebarItem","find","item","match","some","role","role_name","BaseAdminView","props","location","isValidatingToken","children","sidebarList","setSidebarList","authorizedMenu","filter","pathname"],"sources":["/Users/work/Documents/FinalProject/soup/src/Component/BaseAdminView/BaseAdminView.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport Grid from \"@mui/material/Grid\";\n\nimport PaymentIcon from \"@mui/icons-material/Payment\";\nimport PaymentsIcon from \"@mui/icons-material/Payments\";\nimport PersonIcon from \"@mui/icons-material/Person\";\n\nimport { Navigate, useLocation } from \"react-router-dom\";\n\nimport useAuth from \"../../hook/useAuth\";\n\nimport Sidebar from \"./Sidebar\";\n\nconst sidebarItems = [\n  {\n    text: \"Invoice\",\n    icon: <PaymentsIcon />,\n    path: \"/invoice\",\n    child_pattern: /^\\/detailinvoice\\/\\d+$/,\n    roles: [\"user\", \"admin\"],\n  },\n  {\n    text: \"Payment Method\",\n    icon: <PaymentIcon />,\n    path: \"/admin/payment-method\",\n    roles: [\"admin\"],\n  },\n  {\n    text: \"User Page\",\n    icon: <PersonIcon />,\n    path: \"/admin/user\",\n    roles: [\"admin\"],\n  },\n];\n\nfunction isAuthorized(user, path) {\n  const sidebarItem = sidebarItems.find(\n    (item) => item.path === path || path.match(item.child_pattern)\n  );\n  return user && sidebarItem.roles.some((role) => role === user.role_name);\n}\n\nconst BaseAdminView = (props) => {\n  const location = useLocation();\n  const { user, isValidatingToken } = useAuth();\n\n  const { children } = props;\n\n  const [sidebarList, setSidebarList] = useState([]);\n\n  useEffect(() => {\n    const authorizedMenu = sidebarItems.filter((item) =>\n      isAuthorized(user, item.path)\n    );\n    setSidebarList(authorizedMenu);\n  }, [user]);\n\n  if (!isValidatingToken && !isAuthorized(user, location.pathname)) {\n    return <Navigate to={\"/\"} />;\n  }\n\n  return (\n    <Grid container mt={12}>\n      <Grid item xs={2}>\n        <Sidebar items={sidebarList} isAuthorized={isAuthorized} />\n      </Grid>\n      <Grid item xs={10}>\n        {children}\n      </Grid>\n    </Grid>\n  );\n};\n\nexport default BaseAdminView;\n"],"mappings":"6HAAA,MAAOA,MAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAEA,MAAOC,KAAP,KAAiB,oBAAjB,CAEA,MAAOC,YAAP,KAAwB,6BAAxB,CACA,MAAOC,aAAP,KAAyB,8BAAzB,CACA,MAAOC,WAAP,KAAuB,4BAAvB,CAEA,OAASC,QAAT,CAAmBC,WAAnB,KAAsC,kBAAtC,CAEA,MAAOC,QAAP,KAAoB,oBAApB,CAEA,MAAOC,QAAP,KAAoB,WAApB,C,wFAEA,GAAMC,aAAY,CAAG,CACnB,CACEC,IAAI,CAAE,SADR,CAEEC,IAAI,cAAE,KAAC,YAAD,IAFR,CAGEC,IAAI,CAAE,UAHR,CAIEC,aAAa,CAAE,wBAJjB,CAKEC,KAAK,CAAE,CAAC,MAAD,CAAS,OAAT,CALT,CADmB,CAQnB,CACEJ,IAAI,CAAE,gBADR,CAEEC,IAAI,cAAE,KAAC,WAAD,IAFR,CAGEC,IAAI,CAAE,uBAHR,CAIEE,KAAK,CAAE,CAAC,OAAD,CAJT,CARmB,CAcnB,CACEJ,IAAI,CAAE,WADR,CAEEC,IAAI,cAAE,KAAC,UAAD,IAFR,CAGEC,IAAI,CAAE,aAHR,CAIEE,KAAK,CAAE,CAAC,OAAD,CAJT,CAdmB,CAArB,CAsBA,QAASC,aAAT,CAAsBC,IAAtB,CAA4BJ,IAA5B,CAAkC,CAChC,GAAMK,YAAW,CAAGR,YAAY,CAACS,IAAb,CAClB,SAACC,IAAD,QAAUA,KAAI,CAACP,IAAL,GAAcA,IAAd,EAAsBA,IAAI,CAACQ,KAAL,CAAWD,IAAI,CAACN,aAAhB,CAAhC,EADkB,CAApB,CAGA,MAAOG,KAAI,EAAIC,WAAW,CAACH,KAAZ,CAAkBO,IAAlB,CAAuB,SAACC,IAAD,QAAUA,KAAI,GAAKN,IAAI,CAACO,SAAxB,EAAvB,CAAf,CACD,CAED,GAAMC,cAAa,CAAG,QAAhBA,cAAgB,CAACC,KAAD,CAAW,CAC/B,GAAMC,SAAQ,CAAGpB,WAAW,EAA5B,CACA,aAAoCC,OAAO,EAA3C,CAAQS,IAAR,UAAQA,IAAR,CAAcW,iBAAd,UAAcA,iBAAd,CAEA,GAAQC,SAAR,CAAqBH,KAArB,CAAQG,QAAR,CAEA,cAAsC5B,QAAQ,CAAC,EAAD,CAA9C,wCAAO6B,WAAP,eAAoBC,cAApB,eAEA/B,SAAS,CAAC,UAAM,CACd,GAAMgC,eAAc,CAAGtB,YAAY,CAACuB,MAAb,CAAoB,SAACb,IAAD,QACzCJ,aAAY,CAACC,IAAD,CAAOG,IAAI,CAACP,IAAZ,CAD6B,EAApB,CAAvB,CAGAkB,cAAc,CAACC,cAAD,CAAd,CACD,CALQ,CAKN,CAACf,IAAD,CALM,CAAT,CAOA,GAAI,CAACW,iBAAD,EAAsB,CAACZ,YAAY,CAACC,IAAD,CAAOU,QAAQ,CAACO,QAAhB,CAAvC,CAAkE,CAChE,mBAAO,KAAC,QAAD,EAAU,EAAE,CAAE,GAAd,EAAP,CACD,CAED,mBACE,MAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,EAAE,CAAE,EAApB,wBACE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,CAAf,uBACE,KAAC,OAAD,EAAS,KAAK,CAAEJ,WAAhB,CAA6B,YAAY,CAAEd,YAA3C,EADF,EADF,cAIE,KAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,UACGa,QADH,EAJF,GADF,CAUD,CA7BD,CA+BA,cAAeJ,cAAf"},"metadata":{},"sourceType":"module"}