{"ast":null,"code":"import _slicedToArray from\"/Users/work/Documents/FinalProject/soup/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{createContext,useEffect,useState}from\"react\";import{TOKEN_KEY,validateToken}from\"../api/auth\";import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=/*#__PURE__*/createContext();var AuthProvider=function AuthProvider(props){var children=props.children;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isValidatingToken=_useState4[0],setIsValidatingToken=_useState4[1];var storeLoginData=function storeLoginData(data){setUser(data.user_data);localStorage.setItem(TOKEN_KEY,data.token);};var logout=function logout(){setUser(null);localStorage.removeItem(TOKEN_KEY);};// Try to \"login\" using stored token after page refresh\nuseEffect(function(){var token=localStorage.getItem(TOKEN_KEY);if(!token){setIsValidatingToken(false);return;}validateToken(token).then(function(res){setUser(res.data);}).catch(function(err){var res=err===null||err===void 0?void 0:err.response;// Remove token if token has expired or is invalid\nif((res===null||res===void 0?void 0:res.status)===400){localStorage.removeItem(TOKEN_KEY);}setUser(null);}).finally(function(){setIsValidatingToken(false);});},[]);var value={user:user,isValidatingToken:isValidatingToken,storeLoginData:storeLoginData,logout:logout};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};export default AuthContext;export{AuthProvider};","map":{"version":3,"names":["React","createContext","useEffect","useState","TOKEN_KEY","validateToken","AuthContext","AuthProvider","props","children","user","setUser","isValidatingToken","setIsValidatingToken","storeLoginData","data","user_data","localStorage","setItem","token","logout","removeItem","getItem","then","res","catch","err","response","status","finally","value"],"sources":["/Users/work/Documents/FinalProject/soup/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\n\nimport { TOKEN_KEY, validateToken } from \"../api/auth\";\n\nconst AuthContext = createContext();\n\nconst AuthProvider = (props) => {\n  const { children } = props;\n\n  const [user, setUser] = useState(null);\n  const [isValidatingToken, setIsValidatingToken] = useState(true);\n \n\n  const storeLoginData = (data) => {\n    setUser(data.user_data);\n    localStorage.setItem(TOKEN_KEY, data.token);\n  };\n\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem(TOKEN_KEY);\n  };\n\n  // Try to \"login\" using stored token after page refresh\n  useEffect(() => {\n    const token = localStorage.getItem(TOKEN_KEY);\n\n    if (!token) {\n      setIsValidatingToken(false);\n      return;\n    }\n\n    validateToken(token)\n      .then((res) => {\n        setUser(res.data);\n      })\n      .catch((err) => {\n        const res = err?.response\n\n        // Remove token if token has expired or is invalid\n        if (res?.status === 400) {\n          localStorage.removeItem(TOKEN_KEY)\n        }\n\n        setUser(null);\n      })\n      .finally(() => {\n        setIsValidatingToken(false);\n      });\n  }, []);\n\n  const value = {\n    user,\n    isValidatingToken,\n    storeLoginData,\n    logout,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport default AuthContext;\nexport { AuthProvider };\n"],"mappings":"6HAAA,MAAOA,MAAP,EAAgBC,aAAhB,CAA+BC,SAA/B,CAA0CC,QAA1C,KAA0D,OAA1D,CAEA,OAASC,SAAT,CAAoBC,aAApB,KAAyC,aAAzC,C,2CAEA,GAAMC,YAAW,cAAGL,aAAa,EAAjC,CAEA,GAAMM,aAAY,CAAG,QAAfA,aAAe,CAACC,KAAD,CAAW,CAC9B,GAAQC,SAAR,CAAqBD,KAArB,CAAQC,QAAR,CAEA,cAAwBN,QAAQ,CAAC,IAAD,CAAhC,wCAAOO,IAAP,eAAaC,OAAb,eACA,eAAkDR,QAAQ,CAAC,IAAD,CAA1D,yCAAOS,iBAAP,eAA0BC,oBAA1B,eAGA,GAAMC,eAAc,CAAG,QAAjBA,eAAiB,CAACC,IAAD,CAAU,CAC/BJ,OAAO,CAACI,IAAI,CAACC,SAAN,CAAP,CACAC,YAAY,CAACC,OAAb,CAAqBd,SAArB,CAAgCW,IAAI,CAACI,KAArC,EACD,CAHD,CAKA,GAAMC,OAAM,CAAG,QAATA,OAAS,EAAM,CACnBT,OAAO,CAAC,IAAD,CAAP,CACAM,YAAY,CAACI,UAAb,CAAwBjB,SAAxB,EACD,CAHD,CAKA;AACAF,SAAS,CAAC,UAAM,CACd,GAAMiB,MAAK,CAAGF,YAAY,CAACK,OAAb,CAAqBlB,SAArB,CAAd,CAEA,GAAI,CAACe,KAAL,CAAY,CACVN,oBAAoB,CAAC,KAAD,CAApB,CACA,OACD,CAEDR,aAAa,CAACc,KAAD,CAAb,CACGI,IADH,CACQ,SAACC,GAAD,CAAS,CACbb,OAAO,CAACa,GAAG,CAACT,IAAL,CAAP,CACD,CAHH,EAIGU,KAJH,CAIS,SAACC,GAAD,CAAS,CACd,GAAMF,IAAG,CAAGE,GAAH,SAAGA,GAAH,iBAAGA,GAAG,CAAEC,QAAjB,CAEA;AACA,GAAI,CAAAH,GAAG,OAAH,EAAAA,GAAG,SAAH,QAAAA,GAAG,CAAEI,MAAL,IAAgB,GAApB,CAAyB,CACvBX,YAAY,CAACI,UAAb,CAAwBjB,SAAxB,EACD,CAEDO,OAAO,CAAC,IAAD,CAAP,CACD,CAbH,EAcGkB,OAdH,CAcW,UAAM,CACbhB,oBAAoB,CAAC,KAAD,CAApB,CACD,CAhBH,EAiBD,CAzBQ,CAyBN,EAzBM,CAAT,CA2BA,GAAMiB,MAAK,CAAG,CACZpB,IAAI,CAAJA,IADY,CAEZE,iBAAiB,CAAjBA,iBAFY,CAGZE,cAAc,CAAdA,cAHY,CAIZM,MAAM,CAANA,MAJY,CAAd,CAOA,mBAAO,KAAC,WAAD,CAAa,QAAb,EAAsB,KAAK,CAAEU,KAA7B,UAAqCrB,QAArC,EAAP,CACD,CArDD,CAuDA,cAAeH,YAAf,CACA,OAASC,YAAT"},"metadata":{},"sourceType":"module"}