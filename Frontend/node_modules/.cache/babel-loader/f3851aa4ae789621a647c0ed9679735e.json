{"ast":null,"code":"var _jsxFileName = \"/Users/work/Documents/FinalProject/soup/src/context/AuthContext.js\",\n    _s = $RefreshSig$();\n\nimport React, { createContext, useEffect, useState } from \"react\";\nimport { TOKEN_KEY, validateToken } from \"../api/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\n\nconst AuthProvider = props => {\n  _s();\n\n  const {\n    children\n  } = props;\n  const [user, setUser] = useState(null);\n  const [isValidatingToken, setIsValidatingToken] = useState(true);\n\n  const storeLoginData = data => {\n    setUser(data.user_data);\n    localStorage.setItem(TOKEN_KEY, data.token);\n  };\n\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem(TOKEN_KEY);\n  }; // Try to \"login\" using stored token after page refresh\n\n\n  useEffect(() => {\n    const token = localStorage.getItem(TOKEN_KEY);\n\n    if (!token) {\n      setIsValidatingToken(false);\n      return;\n    }\n\n    validateToken(token).then(res => {\n      setUser(res.data);\n    }).catch(err => {\n      const res = err === null || err === void 0 ? void 0 : err.response; // Remove token if token has expired or is invalid\n\n      if ((res === null || res === void 0 ? void 0 : res.status) === 400) {\n        localStorage.removeItem(TOKEN_KEY);\n      }\n\n      setUser(null);\n    }).finally(() => {\n      setIsValidatingToken(false);\n    });\n  }, []);\n  const value = {\n    user,\n    isValidatingToken,\n    storeLoginData,\n    logout\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 59,\n    columnNumber: 10\n  }, this);\n};\n\n_s(AuthProvider, \"B/FeAjCBsITb5UqKuaqjUM6s8lE=\");\n\n_c = AuthProvider;\nexport default AuthContext;\nexport { AuthProvider };\n\nvar _c;\n\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useEffect","useState","TOKEN_KEY","validateToken","AuthContext","AuthProvider","props","children","user","setUser","isValidatingToken","setIsValidatingToken","storeLoginData","data","user_data","localStorage","setItem","token","logout","removeItem","getItem","then","res","catch","err","response","status","finally","value"],"sources":["/Users/work/Documents/FinalProject/soup/src/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useEffect, useState } from \"react\";\n\nimport { TOKEN_KEY, validateToken } from \"../api/auth\";\n\nconst AuthContext = createContext();\n\nconst AuthProvider = (props) => {\n  const { children } = props;\n\n  const [user, setUser] = useState(null);\n  const [isValidatingToken, setIsValidatingToken] = useState(true);\n \n\n  const storeLoginData = (data) => {\n    setUser(data.user_data);\n    localStorage.setItem(TOKEN_KEY, data.token);\n  };\n\n  const logout = () => {\n    setUser(null);\n    localStorage.removeItem(TOKEN_KEY);\n  };\n\n  // Try to \"login\" using stored token after page refresh\n  useEffect(() => {\n    const token = localStorage.getItem(TOKEN_KEY);\n\n    if (!token) {\n      setIsValidatingToken(false);\n      return;\n    }\n\n    validateToken(token)\n      .then((res) => {\n        setUser(res.data);\n      })\n      .catch((err) => {\n        const res = err?.response\n\n        // Remove token if token has expired or is invalid\n        if (res?.status === 400) {\n          localStorage.removeItem(TOKEN_KEY)\n        }\n\n        setUser(null);\n      })\n      .finally(() => {\n        setIsValidatingToken(false);\n      });\n  }, []);\n\n  const value = {\n    user,\n    isValidatingToken,\n    storeLoginData,\n    logout,\n  };\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n};\n\nexport default AuthContext;\nexport { AuthProvider };\n"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,aAAhB,EAA+BC,SAA/B,EAA0CC,QAA1C,QAA0D,OAA1D;AAEA,SAASC,SAAT,EAAoBC,aAApB,QAAyC,aAAzC;;AAEA,MAAMC,WAAW,gBAAGL,aAAa,EAAjC;;AAEA,MAAMM,YAAY,GAAIC,KAAD,IAAW;EAAA;;EAC9B,MAAM;IAAEC;EAAF,IAAeD,KAArB;EAEA,MAAM,CAACE,IAAD,EAAOC,OAAP,IAAkBR,QAAQ,CAAC,IAAD,CAAhC;EACA,MAAM,CAACS,iBAAD,EAAoBC,oBAApB,IAA4CV,QAAQ,CAAC,IAAD,CAA1D;;EAGA,MAAMW,cAAc,GAAIC,IAAD,IAAU;IAC/BJ,OAAO,CAACI,IAAI,CAACC,SAAN,CAAP;IACAC,YAAY,CAACC,OAAb,CAAqBd,SAArB,EAAgCW,IAAI,CAACI,KAArC;EACD,CAHD;;EAKA,MAAMC,MAAM,GAAG,MAAM;IACnBT,OAAO,CAAC,IAAD,CAAP;IACAM,YAAY,CAACI,UAAb,CAAwBjB,SAAxB;EACD,CAHD,CAZ8B,CAiB9B;;;EACAF,SAAS,CAAC,MAAM;IACd,MAAMiB,KAAK,GAAGF,YAAY,CAACK,OAAb,CAAqBlB,SAArB,CAAd;;IAEA,IAAI,CAACe,KAAL,EAAY;MACVN,oBAAoB,CAAC,KAAD,CAApB;MACA;IACD;;IAEDR,aAAa,CAACc,KAAD,CAAb,CACGI,IADH,CACSC,GAAD,IAAS;MACbb,OAAO,CAACa,GAAG,CAACT,IAAL,CAAP;IACD,CAHH,EAIGU,KAJH,CAIUC,GAAD,IAAS;MACd,MAAMF,GAAG,GAAGE,GAAH,aAAGA,GAAH,uBAAGA,GAAG,CAAEC,QAAjB,CADc,CAGd;;MACA,IAAI,CAAAH,GAAG,SAAH,IAAAA,GAAG,WAAH,YAAAA,GAAG,CAAEI,MAAL,MAAgB,GAApB,EAAyB;QACvBX,YAAY,CAACI,UAAb,CAAwBjB,SAAxB;MACD;;MAEDO,OAAO,CAAC,IAAD,CAAP;IACD,CAbH,EAcGkB,OAdH,CAcW,MAAM;MACbhB,oBAAoB,CAAC,KAAD,CAApB;IACD,CAhBH;EAiBD,CAzBQ,EAyBN,EAzBM,CAAT;EA2BA,MAAMiB,KAAK,GAAG;IACZpB,IADY;IAEZE,iBAFY;IAGZE,cAHY;IAIZM;EAJY,CAAd;EAOA,oBAAO,QAAC,WAAD,CAAa,QAAb;IAAsB,KAAK,EAAEU,KAA7B;IAAA,UAAqCrB;EAArC;IAAA;IAAA;IAAA;EAAA,QAAP;AACD,CArDD;;GAAMF,Y;;KAAAA,Y;AAuDN,eAAeD,WAAf;AACA,SAASC,YAAT"},"metadata":{},"sourceType":"module"}